import{u as me,v as K,r as G,j as e,C as ae,P as U}from"./index-BCkWgzQb.js";import{a as j}from"./vendor-CMvHcHbC.js";import{a as ye,u as _e}from"./redux-IAqEd8mO.js";import{c as v,a as L,b as E}from"./index.esm-CCPNyHGR.js";import{u as ce}from"./useLocale-DrialdEC.js";import{u as xe,c as Se,d as be,e as Ce,f as Ne,g as we,r as Fe,h as Re}from"./staff-DDlcHXIU.js";import{e as ke,f as oe,q as je,r as Te,s as te,t as re,c as Ee,a as Ae,v as De,w as le,C as I,j as Le,x as Ie,y as Oe,z as Pe,A as Z,B as Me,D as qe}from"./DefaultLayout-BZcCzWaO.js";import{b as F,c as x,a as V}from"./CRow-D1-3sYH3.js";import{c as O,d as P,b as M,a as Be}from"./CForm-CpmwTKZX.js";import{C as de}from"./CCardHeader-Dyhz8jtB.js";import{c as ue,a as He}from"./cil-save-CuPF9_Mc.js";import{C as Q}from"./CInputGroup-D-nF2F6K.js";import{C as ie}from"./CInputGroupText-CZAH0dMK.js";import{c as he}from"./cil-user-Ddrdy7PS.js";import{C as ne,a as Y,b as ee,c as k,d as p,e as se,f as u}from"./CTable-dap83gV6.js";import{c as $e}from"./cil-options-sHCm5Gxk.js";var ze=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M19.409,431.289v41.468a24.124,24.124,0,0,0,24.1,24.1H76.877A149.445,149.445,0,0,0,183.25,452.792L383.966,252.075l55.846,56.069,22.671-22.582-55.889-56.114,1.287-1.288-.021-.02,63.287-63.287a84.853,84.853,0,0,0,0-120l-4-4a84.852,84.852,0,0,0-120,0l-64.326,64.326L230.947,53.1,208.275,75.68,260.387,128,63.471,324.916A149.449,149.449,0,0,0,19.409,431.289ZM369.774,63.48a52.854,52.854,0,0,1,74.747,0l4,4a52.913,52.913,0,0,1,0,74.745L387.147,203.6,308.4,124.853Zm-85.72,86.107,78.573,78.573-69.176,69.176v-.483H136.788ZM104.788,328.853H261.935L160.623,430.165a117.662,117.662,0,0,1-83.746,34.688H51.409V431.289A117.664,117.664,0,0,1,86.1,347.543Z' class='ci-primary'/>"],pe=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>"];const ge=({staff:l=null,onClose:C,onSuccess:i})=>{const{business:t,user:c}=me(),{t:r}=ce(),[h,q]=j.useState(!1),[N,_]=j.useState(""),[A,D]=j.useState([]),[T,y]=j.useState(!0),[d,S]=j.useState({first_name:"",last_name:"",email:"",phone:"",role:G.junior_employee,commission_rate:10,is_available_for_booking:!0,working_hours:K,service_ids:[]}),[b,B]=j.useState(K);j.useEffect(()=>{H()},[t==null?void 0:t.id]),j.useEffect(()=>{if(l){const a=l.employee_services?l.employee_services.map(o=>o.service_id):[];S({first_name:l.first_name||"",last_name:l.last_name||"",email:l.email||"",phone:l.phone||"",role:l.role||G.junior_employee,commission_rate:l.commission_rate||0,is_available_for_booking:l.is_available_for_booking!==!1,working_hours:l.working_hours||K,service_ids:a}),B(l.working_hours||K)}},[l]);const H=async()=>{if(t!=null&&t.id){y(!0);try{const{data:a,error:o}=await ke(t.id);o?console.error("Error loading services:",o):D(a||[])}catch(a){console.error("Error loading services:",a)}finally{y(!1)}}},w=(a,o)=>{S(s=>({...s,[a]:o}))},$=a=>{S(o=>{const s=o.service_ids.includes(a)?o.service_ids.filter(f=>f!==a):[...o.service_ids,a];return{...o,service_ids:s}})},R=(a,o,s)=>{const f={...b,[a]:{...b[a],[o]:s}};B(f),S(g=>({...g,working_hours:f}))},z=()=>d.first_name.trim()?d.last_name.trim()?d.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)?d.commission_rate<0||d.commission_rate>100?(_(r("staff.errors.commissionRateInvalid")),!1):!0:(_(r("staff.errors.validEmailRequired")),!1):(_(r("staff.errors.emailRequired")),!1):(_(r("staff.errors.lastNameRequired")),!1):(_(r("staff.errors.firstNameRequired")),!1),W=async a=>{if(a.preventDefault(),_(""),!!z()){q(!0);try{const o={...d,business_id:t.id,working_hours:b,created_by:c.id,updated_by:c.id};let s;l?s=await xe(l.id,o):s=await Se(o),s.error?_(s.error):i(s.data)}catch(o){_(o.message||r("staff.errors.genericError"))}finally{q(!1)}}},n={monday:r("staff.days.monday"),tuesday:r("staff.days.tuesday"),wednesday:r("staff.days.wednesday"),thursday:r("staff.days.thursday"),friday:r("staff.days.friday"),saturday:r("staff.days.saturday"),sunday:r("staff.days.sunday")},m=[{value:G.manager,label:r("staff.roles.manager")},{value:G.reception,label:r("staff.roles.reception")},{value:G.senior_employee,label:r("staff.roles.seniorEmployee")},{value:G.junior_employee,label:r("staff.roles.juniorEmployee")}];return e.jsx(F,{children:e.jsx(x,{xs:12,children:e.jsxs(O,{className:"mb-4",children:[e.jsx(de,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:r(l?"staff.form.editStaff":"staff.form.addNewStaff")}),e.jsxs(V,{color:"light",onClick:C,disabled:h,children:[e.jsx(v,{icon:ue,className:"me-2"}),r("staff.form.back")]})]})}),e.jsxs(P,{children:[N&&e.jsx(M,{color:"danger",dismissible:!0,onClose:()=>_(""),children:N}),e.jsxs(Be,{onSubmit:W,children:[e.jsxs(F,{children:[e.jsx(x,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"first_name",children:[r("staff.form.firstName")," *"]}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(v,{icon:he})}),e.jsx(E,{type:"text",id:"first_name",placeholder:r("staff.form.firstNamePlaceholder"),value:d.first_name,onChange:a=>w("first_name",a.target.value),required:!0,disabled:h})]})]})}),e.jsx(x,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"last_name",children:[r("staff.form.lastName")," *"]}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(v,{icon:he})}),e.jsx(E,{type:"text",id:"last_name",placeholder:r("staff.form.lastNamePlaceholder"),value:d.last_name,onChange:a=>w("last_name",a.target.value),required:!0,disabled:h})]})]})})]}),e.jsxs(F,{children:[e.jsx(x,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"email",children:[r("staff.form.email")," *"]}),e.jsx(E,{type:"email",id:"email",placeholder:r("staff.form.emailPlaceholder"),value:d.email,onChange:a=>w("email",a.target.value),required:!0,disabled:h||l}),l&&e.jsx("small",{className:"text-muted",children:r("staff.form.emailCannotChange")})]})}),e.jsx(x,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(L,{htmlFor:"phone",children:r("staff.form.phone")}),e.jsxs(Q,{children:[e.jsx(ie,{children:e.jsx(v,{icon:pe})}),e.jsx(E,{type:"tel",id:"phone",placeholder:r("staff.form.phonePlaceholder"),value:d.phone,onChange:a=>w("phone",a.target.value),disabled:h})]})]})})]}),e.jsxs(F,{children:[e.jsx(x,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"role",children:[r("staff.form.role")," *"]}),e.jsx(oe,{id:"role",value:d.role,onChange:a=>w("role",a.target.value),required:!0,disabled:h,children:m.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})}),e.jsx(x,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(L,{htmlFor:"commission_rate",children:r("staff.form.commissionRate")}),e.jsx(E,{type:"number",id:"commission_rate",min:"0",max:"100",step:"0.1",value:d.commission_rate,onChange:a=>w("commission_rate",parseFloat(a.target.value)||0),disabled:h})]})})]}),e.jsx(F,{className:"mb-4",children:e.jsx(x,{xs:12,children:e.jsx(ne,{id:"is_available_for_booking",checked:d.is_available_for_booking,onChange:a=>w("is_available_for_booking",a.target.checked),label:r("staff.form.availableForBooking"),disabled:h})})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:r("staff.form.assignedServices")}),T?e.jsx("div",{className:"text-center py-4",children:e.jsx(ae,{})}):A.length===0?e.jsx(M,{color:"info",children:r("staff.form.noServicesAvailable")}):e.jsx("div",{className:"border rounded p-3",children:A.map(a=>e.jsx(ne,{id:`service-${a.id}`,checked:d.service_ids.includes(a.id),onChange:()=>$(a.id),label:`${a.name} - ${a.duration_minutes} min - ${a.price} PLN`,disabled:h,className:"mb-2"},a.id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:r("staff.form.workingHours")}),Object.entries(n).map(([a,o])=>{var s,f,g,X,fe;return e.jsxs(F,{className:"mb-2 align-items-center",children:[e.jsx(x,{md:2,children:e.jsx(L,{className:"mb-0",children:o})}),e.jsx(x,{md:2,children:e.jsx(ne,{checked:((s=b[a])==null?void 0:s.available)!==!1,onChange:J=>R(a,"available",J.target.checked),label:r("staff.form.available"),disabled:h})}),e.jsx(x,{md:3,children:e.jsx(E,{type:"time",value:((f=b[a])==null?void 0:f.start)||"09:00",onChange:J=>R(a,"start",J.target.value),disabled:h||!((g=b[a])!=null&&g.available)})}),e.jsx(x,{md:3,children:e.jsx(E,{type:"time",value:((X=b[a])==null?void 0:X.end)||"17:00",onChange:J=>R(a,"end",J.target.value),disabled:h||!((fe=b[a])!=null&&fe.available)})})]},a)})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(V,{type:"button",color:"secondary",onClick:C,disabled:h,children:r("staff.form.cancel")}),e.jsx(V,{type:"submit",color:"primary",disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(ae,{size:"sm",className:"me-2"}),r(l?"staff.form.updating":"staff.form.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{icon:He,className:"me-2"}),r(l?"staff.form.updateStaff":"staff.form.createStaff")]})})]})]})]})]})})})};ge.propTypes={staff:U.object,onClose:U.func.isRequired,onSuccess:U.func.isRequired};const ve=({staffId:l,onBack:C,onEdit:i})=>{const{t}=ce(),[c,r]=j.useState(null),[h,q]=j.useState([]),[N,_]=j.useState(null),[A,D]=j.useState(!0),[T,y]=j.useState(""),[d,S]=j.useState("details");j.useEffect(()=>{l&&b()},[l]),j.useEffect(()=>{d==="schedule"&&c?B():d==="performance"&&c&&H()},[d,c]);const b=async()=>{D(!0),y("");try{const{data:n,error:m}=await be(l);m?y(m):r(n)}catch(n){y(n.message)}finally{D(!1)}},B=async()=>{const n=new Date,m=n.toISOString().split("T")[0],a=new Date(n.getTime()+336*60*60*1e3).toISOString().split("T")[0];try{const{data:o,error:s}=await Ce(l,m,a);s?y(s):q(o||[])}catch(o){y(o.message)}},H=async()=>{const n=new Date,m=new Date(n.getTime()-720*60*60*1e3).toISOString().split("T")[0],a=n.toISOString().split("T")[0];try{const{data:o,error:s}=await Ne(l,m,a);s?y(s):_(o)}catch(o){y(o.message)}},w=n=>{const a={active:{color:"success",text:t("staff.status.active")},invited:{color:"warning",text:t("staff.status.invited")},inactive:{color:"secondary",text:t("staff.status.inactive")},terminated:{color:"danger",text:t("staff.status.terminated")}}[n]||{color:"secondary",text:n};return e.jsx(I,{color:a.color,children:a.text})},$=n=>{const a={owner:{color:"primary",text:t("staff.roles.owner")},manager:{color:"info",text:t("staff.roles.manager")},reception:{color:"success",text:t("staff.roles.reception")},senior_employee:{color:"warning",text:t("staff.roles.seniorEmployee")},junior_employee:{color:"secondary",text:t("staff.roles.juniorEmployee")}}[n]||{color:"secondary",text:n};return e.jsx(I,{color:a.color,children:a.text})},R=n=>new Date(`2000-01-01T${n}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),z=n=>new Date(n).toLocaleDateString(),W=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];return A?e.jsx("div",{className:"text-center p-4",children:e.jsx(ae,{})}):T?e.jsx(M,{color:"danger",children:T}):c?e.jsx(F,{children:e.jsx(x,{xs:12,children:e.jsxs(O,{className:"mb-4",children:[e.jsx(de,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:t("staff.details.title")}),e.jsxs("div",{children:[e.jsxs(V,{color:"primary",size:"sm",className:"me-2",onClick:()=>i(c),children:[e.jsx(v,{icon:je,className:"me-2"}),t("staff.actions.edit")]}),e.jsxs(V,{color:"secondary",variant:"ghost",onClick:C,children:[e.jsx(v,{icon:ue,className:"me-2"}),t("staff.form.back")]})]})]})}),e.jsxs(P,{children:[e.jsxs(Te,{variant:"tabs",className:"mb-3",children:[e.jsx(te,{children:e.jsx(re,{active:d==="details",onClick:()=>S("details"),style:{cursor:"pointer"},children:t("staff.details.tabs.details")})}),e.jsx(te,{children:e.jsxs(re,{active:d==="schedule",onClick:()=>S("schedule"),style:{cursor:"pointer"},children:[e.jsx(v,{icon:Ee,className:"me-2"}),t("staff.details.tabs.schedule")]})}),e.jsx(te,{children:e.jsxs(re,{active:d==="performance",onClick:()=>S("performance"),style:{cursor:"pointer"},children:[e.jsx(v,{icon:Ae,className:"me-2"}),t("staff.details.tabs.performance")]})})]}),e.jsxs(De,{children:[e.jsx(le,{visible:d==="details",children:e.jsxs(F,{children:[e.jsxs(x,{md:6,children:[e.jsx("h5",{children:t("staff.details.personalInfo")}),e.jsx("table",{className:"table table-borderless",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.name"),":"]})}),e.jsxs("td",{children:[c.first_name," ",c.last_name]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.email"),":"]})}),e.jsx("td",{children:c.email})]}),c.phone&&e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.phone"),":"]})}),e.jsxs("td",{children:[e.jsx(v,{icon:pe,className:"me-2"}),c.phone]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.role"),":"]})}),e.jsx("td",{children:$(c.role)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.status"),":"]})}),e.jsx("td",{children:w(c.status)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.commissionRate"),":"]})}),e.jsxs("td",{children:[c.commission_rate,"%"]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.availableForBooking"),":"]})}),e.jsx("td",{children:e.jsx(I,{color:c.is_available_for_booking?"success":"secondary",children:c.is_available_for_booking?t("staff.details.yes"):t("staff.details.no")})})]}),c.joined_at&&e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[t("staff.details.joined"),":"]})}),e.jsx("td",{children:z(c.joined_at)})]})]})})]}),e.jsxs(x,{md:6,children:[e.jsx("h5",{children:t("staff.details.workingHours")}),e.jsxs(Y,{small:!0,children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(p,{children:t("staff.details.day")}),e.jsx(p,{children:t("staff.details.hours")})]})}),e.jsx(se,{children:c.working_hours&&W.map(n=>{const m=c.working_hours[n];return m?e.jsxs(k,{children:[e.jsx(u,{className:"text-capitalize",children:t(`staff.days.${n}`)}),e.jsx(u,{children:m.available===!1?e.jsx(I,{color:"secondary",children:t("staff.details.notWorking")}):`${R(m.start)} - ${R(m.end)}`})]},n):null})})]}),c.employee_services&&c.employee_services.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"mt-4",children:t("staff.details.assignedServices")}),e.jsxs(Y,{small:!0,children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(p,{children:t("staff.details.service")}),e.jsx(p,{children:t("staff.details.price")}),e.jsx(p,{children:t("staff.details.duration")})]})}),e.jsx(se,{children:c.employee_services.map(n=>{var m,a,o;return e.jsxs(k,{children:[e.jsx(u,{children:(m=n.services)==null?void 0:m.name}),e.jsxs(u,{children:["PLN ",(a=n.services)==null?void 0:a.price]}),e.jsxs(u,{children:[(o=n.services)==null?void 0:o.duration_minutes," min"]})]},n.id)})})]})]})]})]})}),e.jsxs(le,{visible:d==="schedule",children:[e.jsx("h5",{children:t("staff.details.schedule.title")}),h.length===0?e.jsx(M,{color:"info",children:t("staff.details.schedule.noAppointments")}):e.jsxs(Y,{hover:!0,children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(p,{children:t("staff.details.schedule.date")}),e.jsx(p,{children:t("staff.details.schedule.time")}),e.jsx(p,{children:t("staff.details.schedule.client")}),e.jsx(p,{children:t("staff.details.schedule.service")}),e.jsx(p,{children:t("staff.details.schedule.duration")}),e.jsx(p,{children:t("staff.details.schedule.status")})]})}),e.jsx(se,{children:h.map(n=>{var m,a,o;return e.jsxs(k,{children:[e.jsx(u,{children:z(n.appointment_date)}),e.jsx(u,{children:R(n.start_time)}),e.jsxs(u,{children:[(m=n.clients)==null?void 0:m.first_name," ",(a=n.clients)==null?void 0:a.last_name]}),e.jsx(u,{children:(o=n.services)==null?void 0:o.name}),e.jsxs(u,{children:[n.duration_minutes," min"]}),e.jsx(u,{children:e.jsx(I,{color:n.status==="completed"?"success":"primary",children:n.status})})]},n.id)})})]})]}),e.jsxs(le,{visible:d==="performance",children:[e.jsx("h5",{children:t("staff.details.performance.title")}),N?e.jsxs(F,{children:[e.jsx(x,{md:3,children:e.jsx(O,{className:"text-center",children:e.jsxs(P,{children:[e.jsx("h4",{className:"text-primary",children:N.total_appointments}),e.jsx("p",{className:"text-muted mb-0",children:t("staff.details.performance.totalAppointments")})]})})}),e.jsx(x,{md:3,children:e.jsx(O,{className:"text-center",children:e.jsxs(P,{children:[e.jsx("h4",{className:"text-success",children:N.completed_appointments}),e.jsx("p",{className:"text-muted mb-0",children:t("staff.details.performance.completed")})]})})}),e.jsx(x,{md:3,children:e.jsx(O,{className:"text-center",children:e.jsxs(P,{children:[e.jsxs("h4",{className:"text-info",children:[N.completion_rate.toFixed(1),"%"]}),e.jsx("p",{className:"text-muted mb-0",children:t("staff.details.performance.completionRate")})]})})}),e.jsx(x,{md:3,children:e.jsx(O,{className:"text-center",children:e.jsxs(P,{children:[e.jsxs("h4",{className:"text-warning",children:["PLN ",N.total_revenue.toFixed(2)]}),e.jsx("p",{className:"text-muted mb-0",children:t("staff.details.performance.totalRevenue")})]})})})]}):e.jsx(M,{color:"info",children:t("staff.details.performance.loading")})]})]})]})]})})}):e.jsx(M,{color:"warning",children:t("staff.errors.staffNotFound")})};ve.propTypes={staffId:U.string.isRequired,onBack:U.func.isRequired,onEdit:U.func.isRequired};const is=()=>{const l=ye(),{business:C}=me(),{t:i}=ce(),{staff:t,loading:c,error:r,filters:h}=_e(s=>s.staff),[q,N]=j.useState(!1),[_,A]=j.useState(null),[D,T]=j.useState(null),[y,d]=j.useState("");j.useEffect(()=>{C!=null&&C.id&&S()},[C==null?void 0:C.id,h]);const S=async()=>{console.log("[todo loadStaff()]"),l({type:"STAFF_LOADING"});try{const{data:s,error:f}=await we(C.id,h);console.log("[todo loadStaff()] getStaff ",{data:s,error:f}),f?(console.log("[todo loadStaff] STAFF_ERROR"),l({type:"STAFF_ERROR",payload:f})):(console.log("[todo loadStaff] STAFF_SUCCESS"),l({type:"STAFF_SUCCESS",payload:s||[]}))}catch(s){l({type:"STAFF_ERROR",payload:s.message})}},b=(s,f)=>{l({type:"SET_STAFF_FILTERS",payload:{[s]:f}})},B=s=>{T(s)},H=s=>{A(s),N(!0)},w=async s=>{if(window.confirm(i("staff.confirmDelete")))try{l({type:"STAFF_LOADING"});const{error:f}=await Re(s);f?l({type:"STAFF_ERROR",payload:f}):await S()}catch(f){l({type:"STAFF_ERROR",payload:f.message})}},$=async(s,f)=>{try{l({type:"STAFF_LOADING"});const{data:g,error:X}=await xe(s,{status:f});X?l({type:"STAFF_ERROR",payload:X}):await S()}catch(g){l({type:"STAFF_ERROR",payload:g.message})}},R=()=>{N(!1),A(null)},z=()=>{T(null)},W=async s=>{await S(),R()},n=async s=>{try{l({type:"STAFF_LOADING"});const{success:f,error:g}=await Fe(s);g?l({type:"STAFF_ERROR",payload:g}):(l({type:"STAFF_SUCCESS",payload:t}),alert(i("staff.invitationResent")))}catch(f){l({type:"STAFF_ERROR",payload:f.message})}},m=s=>{const g={active:{color:"success",text:i("staff.status.active")},invited:{color:"warning",text:i("staff.status.invited")},inactive:{color:"secondary",text:i("staff.status.inactive")},terminated:{color:"danger",text:i("staff.status.terminated")}}[s]||{color:"secondary",text:s};return e.jsx(I,{color:g.color,children:g.text})},a=s=>{const g={owner:{color:"primary",text:i("staff.roles.owner")},manager:{color:"info",text:i("staff.roles.manager")},reception:{color:"success",text:i("staff.roles.reception")},senior_employee:{color:"warning",text:i("staff.roles.seniorEmployee")},junior_employee:{color:"secondary",text:i("staff.roles.juniorEmployee")}}[s]||{color:"secondary",text:s};return e.jsx(I,{color:g.color,children:g.text})},o=t.filter(s=>s.first_name.toLowerCase().includes(y.toLowerCase())||s.last_name.toLowerCase().includes(y.toLowerCase())||s.email.toLowerCase().includes(y.toLowerCase()));return D?e.jsx(ve,{staffId:D.id,onBack:z,onEdit:s=>{T(null),H(s)}}):q?e.jsx(ge,{staff:_,onClose:R,onSuccess:W}):e.jsx(F,{children:e.jsx(x,{xs:12,children:e.jsxs(O,{className:"mb-4",children:[e.jsx(de,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:i("staff.title")}),e.jsxs(V,{color:"primary",onClick:()=>N(!0),children:[e.jsx(v,{icon:Le,className:"me-2"}),i("staff.addStaff")]})]})}),e.jsxs(P,{children:[r&&e.jsx(M,{color:"danger",dismissible:!0,children:r}),e.jsxs(F,{className:"mb-3",children:[e.jsx(x,{md:4,children:e.jsx(Q,{children:e.jsx(E,{placeholder:i("staff.searchPlaceholder"),value:y,onChange:s=>d(s.target.value)})})}),e.jsx(x,{md:3,children:e.jsxs(oe,{value:h.status,onChange:s=>b("status",s.target.value),children:[e.jsx("option",{value:"all",children:i("staff.filters.allStatus")}),e.jsx("option",{value:"active",children:i("staff.status.active")}),e.jsx("option",{value:"invited",children:i("staff.status.invited")}),e.jsx("option",{value:"inactive",children:i("staff.status.inactive")}),e.jsx("option",{value:"terminated",children:i("staff.status.terminated")})]})}),e.jsx(x,{md:3,children:e.jsxs(oe,{value:h.role,onChange:s=>b("role",s.target.value),children:[e.jsx("option",{value:"all",children:i("staff.filters.allRoles")}),e.jsx("option",{value:"manager",children:i("staff.roles.manager")}),e.jsx("option",{value:"reception",children:i("staff.roles.reception")}),e.jsx("option",{value:"senior_employee",children:i("staff.roles.seniorEmployee")}),e.jsx("option",{value:"junior_employee",children:i("staff.roles.juniorEmployee")})]})})]}),c?e.jsx("div",{className:"text-center p-4",children:e.jsx(ae,{})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{overflowX:"auto",minHeight:"400px"},children:e.jsxs(Y,{hover:!0,children:[e.jsx(ee,{children:e.jsxs(k,{children:[e.jsx(p,{children:i("staff.table.name")}),e.jsx(p,{children:i("staff.table.email")}),e.jsx(p,{children:i("staff.table.role")}),e.jsx(p,{children:i("staff.table.status")}),e.jsx(p,{children:i("staff.table.commission")}),e.jsx(p,{style:{width:"80px"},children:i("staff.table.actions")})]})}),e.jsx(se,{children:o.length===0?e.jsx(k,{children:e.jsx(u,{colSpan:"6",className:"text-center",children:i("staff.noStaffFound")})}):o.map(s=>e.jsxs(k,{children:[e.jsx(u,{children:e.jsxs("strong",{children:[s.first_name," ",s.last_name]})}),e.jsx(u,{children:s.email}),e.jsx(u,{children:a(s.role)}),e.jsx(u,{children:m(s.status)}),e.jsxs(u,{children:[s.commission_rate,"%"]}),e.jsx(u,{children:e.jsxs(Ie,{alignment:"end",direction:"up",children:[e.jsx(Oe,{size:"sm",color:"ghost",children:e.jsx(v,{icon:$e})}),e.jsxs(Pe,{children:[e.jsxs(Z,{onClick:()=>B(s),children:[e.jsx(v,{icon:ze,className:"me-2"}),i("staff.actions.viewDetails")]}),e.jsxs(Z,{onClick:()=>H(s),children:[e.jsx(v,{icon:je,className:"me-2"}),i("staff.actions.edit")]}),s.status==="invited"&&e.jsxs(Z,{onClick:()=>n(s.id),children:[e.jsx(v,{icon:Me,className:"me-2"}),i("staff.actions.resendInvitation")]}),s.status==="active"&&e.jsx(Z,{onClick:()=>$(s.id,"inactive"),children:i("staff.actions.deactivate")}),s.status==="inactive"&&e.jsx(Z,{onClick:()=>$(s.id,"active"),children:i("staff.actions.activate")}),e.jsxs(Z,{className:"text-danger",onClick:()=>w(s.id),children:[e.jsx(v,{icon:qe,className:"me-2"}),i("staff.actions.delete")]})]})]})})]},s.id))})]})}),o.length>0&&e.jsx("div",{className:"text-center text-muted py-3",style:{fontSize:"0.875rem",borderTop:"1px solid #d8dbe0"},children:i("staff.endOfList",{count:o.length,plural:o.length!==1?"s":""})})]})]})]})})})};export{is as default};
